{% extends 'base.html' %}
{% load static %}

{% block title %}{{ team.name }} - Спортивные Фанаты{% endblock %}

{% block content %}
<div class="container">
    <div class="team-detail-header">
        <div class="team-hero">
            <div class="team-logo-large">
                <img src="{% static 'images/teams/' %}{{ team.logo }}" 
                     alt="{{ team.name }}" 
                     onerror="this.src='{% static 'images/default-team.png' %}'">
            </div>
            <div class="team-main-info">
                <h1>{{ team.name }}</h1>
                <p class="team-league-large">{{ team.league }}</p>
                <p class="team-country-large">
                    <i class="fas fa-map-marker-alt"></i> {{ team.country }}
                </p>
                <div class="team-actions-large">
                    <button class="btn {% if is_favorite %}btn-danger{% else %}btn-primary{% endif %}" 
                            onclick="toggleFavorite({{ team.id }})" 
                            id="favorite-btn-{{ team.id }}">
                        <i class="fas fa-heart"></i>
                        {% if is_favorite %}Удалить из избранного{% else %}Добавить в избранное{% endif %}
                    </button>
                    <a href="{% url 'home' %}" class="btn btn-outline">
                        <i class="fas fa-arrow-left"></i> Назад
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="team-detail-content">
        <div class="team-info-grid">
            <!-- Основная информация -->
            <div class="info-section">
                <h2><i class="fas fa-info-circle"></i> Основная информация</h2>
                <div class="info-card">
                    <div class="info-item">
                        <span class="info-label">Название:</span>
                        <span class="info-value">{{ team.name }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Лига:</span>
                        <span class="info-value">{{ team.league }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Страна:</span>
                        <span class="info-value">{{ team.country }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Год основания:</span>
                        <span class="info-value">{{ team.founded }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Возраст клуба:</span>
                        <span class="info-value">{{ team.founded|add:"-2025"|add:"-1"|abs }} лет</span>
                    </div>
                </div>
            </div>

            <!-- Описание -->
            <div class="info-section">
                <h2><i class="fas fa-align-left"></i> О команде</h2>
                <div class="info-card">
                    <p class="team-description">{{ team.description }}</p>
                </div>
            </div>

            <!-- Достижения (статичные данные) -->
            <div class="info-section">
                <h2><i class="fas fa-trophy"></i> Достижения</h2>
                <div class="info-card">
                    <div class="achievements-list">
                        {% if team.name == "Real Madrid" %}
                            <div class="achievement-item">
                                <i class="fas fa-crown"></i>
                                <span>14 побед в Лиге Чемпионов УЕФА</span>
                            </div>
                            <div class="achievement-item">
                                <i class="fas fa-medal"></i>
                                <span>35 чемпионств Ла Лиги</span>
                            </div>
                        {% elif team.name == "Manchester United" %}
                            <div class="achievement-item">
                                <i class="fas fa-crown"></i>
                                <span>3 победы в Лиге Чемпионов</span>
                            </div>
                            <div class="achievement-item">
                                <i class="fas fa-medal"></i>
                                <span>20 чемпионств Премьер-лиги</span>
                            </div>
                        {% elif team.name == "Barcelona" %}
                            <div class="achievement-item">
                                <i class="fas fa-crown"></i>
                                <span>5 побед в Лиге Чемпионов</span>
                            </div>
                            <div class="achievement-item">
                                <i class="fas fa-medal"></i>
                                <span>27 чемпионств Ла Лиги</span>
                            </div>
                        {% else %}
                            <div class="achievement-item">
                                <i class="fas fa-trophy"></i>
                                <span>Множественный чемпион национальной лиги</span>
                            </div>
                            <div class="achievement-item">
                                <i class="fas fa-medal"></i>
                                <span>Участник европейских турниров</span>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Статистика -->
            <div class="info-section">
                <h2><i class="fas fa-chart-bar"></i> Статистика</h2>
                <div class="info-card">
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-number">{{ team.founded|add:"-1900"|abs }}</div>
                            <div class="stat-label">Лет истории</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">15+</div>
                            <div class="stat-label">Трофеев</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">25</div>
                            <div class="stat-label">Игроков</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">50K+</div>
                            <div class="stat-label">Фанатов</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Последние новости (заглушка) -->
            <div class="info-section">
                <h2><i class="fas fa-newspaper"></i> Последние новости</h2>
                <div class="info-card">
                    <div class="news-list">
                        <div class="news-item">
                            <div class="news-date">10.09.2025</div>
                            <div class="news-title">Подготовка к новому сезону</div>
                            <div class="news-excerpt">Команда активно готовится к предстоящему сезону...</div>
                        </div>
                        <div class="news-item">
                            <div class="news-date">08.09.2025</div>
                            <div class="news-title">Новые трансферы</div>
                            <div class="news-excerpt">Клуб объявил о подписании новых игроков...</div>
                        </div>
                        <div class="news-item">
                            <div class="news-date">05.09.2025</div>
                            <div class="news-title">Тренировочный лагерь</div>
                            <div class="news-excerpt">Команда проводит сборы в подготовке к сезону...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Фотогалерея (заглушка) -->
            <div class="info-section">
                <h2><i class="fas fa-images"></i> Фотогалерея</h2>
                <div class="info-card">
                    <div class="gallery-grid">
                        <div class="gallery-item">
                            <img src="{% static 'images/gallery/stadium1.jpg' %}" 
                                 alt="Стадион" 
                                 onerror="this.src='{% static 'images/default-stadium.jpg' %}'">
                        </div>
                        <div class="gallery-item">
                            <img src="{% static 'images/gallery/team1.jpg' %}" 
                                 alt="Команда" 
                                 onerror="this.src='{% static 'images/default-team-photo.jpg' %}'">
                        </div>
                        <div class="gallery-item">
                            <img src="{% static 'images/gallery/fans1.jpg' %}" 
                                 alt="Фанаты" 
                                 onerror="this.src='{% static 'images/default-fans.jpg' %}'">
                        </div>
                        <div class="gallery-item">
                            <img src="{% static 'images/gallery/trophy1.jpg' %}" 
                                 alt="Трофей" 
                                 onerror="this.src='{% static 'images/default-trophy.jpg' %}'">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function toggleFavorite(teamId) {
    fetch('{% url "toggle_favorite" %}', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            team_id: teamId
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            const btn = document.getElementById(`favorite-btn-${teamId}`);
            if (data.is_favorite) {
                btn.classList.remove('btn-primary');
                btn.classList.add('btn-danger');
                btn.innerHTML = '<i class="fas fa-heart"></i> Удалить из избранного';
            } else {
                btn.classList.remove('btn-danger');
                btn.classList.add('btn-primary');
                btn.innerHTML = '<i class="fas fa-heart"></i> Добавить в избранное';
            }
            
            // Показываем уведомление
            showNotification(data.message, data.is_favorite ? 'success' : 'info');
        } else {
            showNotification('Ошибка при обновлении избранного', 'error');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        showNotification('Произошла ошибка', 'error');
    });
}

function showNotification(message, type) {
    const notification = document.createElement('div');
    notification.className = `notification notification-${type}`;
    notification.textContent = message;
    
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 15px 20px;
        border-radius: 5px;
        color: white;
        font-weight: bold;
        z-index: 1000;
        opacity: 0;
        transition: opacity 0.3s ease;
    `;
    
    if (type === 'success') notification.style.backgroundColor = '#4CAF50';
    else if (type === 'error') notification.style.backgroundColor = '#f44336';
    else notification.style.backgroundColor = '#2196F3';
    
    document.body.appendChild(notification);
    
    setTimeout(() => notification.style.opacity = '1', 100);
    
    setTimeout(() => {
        notification.style.opacity = '0';
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 300);
    }, 3000);
}
</script>
{% endblock %}